<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Making your first ScratchGame</title>
    <script src="lib/phaser.min.js"></script>
    <script src="lib/ScratchGame.js"></script>
    <script src="lib/CloneSys.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>

<body>

    <script type="text/javascript">
        let game = new ScratchGame(800, 600);
        game.preload = preload;
        game.create = create;
        game.update = update;

        function preload() {
            this.loadImage('sky', 'assets/sky.png');
            this.loadSpritesheet('dude', 'assets/dude.png', 32, 48);
        }

        function create() {
            planeTest = initPlane(32, 48, 32, 48, 15, 10, 'dude');
            game.changeBackground('sky');
            planeTest.deletePlanePart(1, 1, 3, 3); 
        }

        tick = 0;
        hide = 0;
        lines = 5;

        function update() {       
            ++tick;

            if(tick % 25 == 0){
                ++hide;
                planeTest.runAll(move);
            }

            if(game.isKeyDown('SPACE')){
                planeTest.runAll(updateCostume);
            }
        }

        function move(x, y){
            if((x + y) % lines == hide % lines){
                planeTest.plane[x][y].visible = false;
            } else {
                planeTest.plane[x][y].visible = true;
            }
        }

        function updateCostume(x, y){
            if(planeTest.plane[x][y].visible){
                planeTest.plane[x][y].nextCostume();
            }
        }
    </script>

</body>

</html>